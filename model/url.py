from model.db import DB


class URL(DB):
    TABLE = 'urls'
    COLS_IGNORE = ['created_at', 'updated_at']
    COLS_EXE_FCT = ['source_link_md5']

    def __init__(self):
        params = {
            'table_name': self.TABLE
        }
        super().__init__(**params)

    def insert(self, data):
        # public_id column generated by generate_public_id('urls'::text, 8) function so no need to insert
        data['source_link_md5'] = f"MD5('{data['source_link']}')"
        return super().insert(data)
